/*! primedesk 2026-02-17*/
var App=angular.module("App",["ngRoute","appControllers"]),appControllers=angular.module("appControllers",[]);App.config(["$routeProvider","$httpProvider",function(e,t){e.when("/home",{templateUrl:"/views/about.html",controller:"calculatorController"}).when("/ticket",{templateUrl:"/views/ticket.html",controller:"ticketController"}).when("/apiInstructions",{templateUrl:"/views/apiInstructions.html",controller:"apiInstructionsController"}).when("/register",{templateUrl:"/views/register.html",controller:"registerController"}).when("/allTickets",{templateUrl:"/views/allTickets.html",controller:"allTicketController"}).otherwise({redirectTo:"/home"})}]),App.service("browser",["$window",function(r){return function(){var e,t=r.navigator.userAgent,o={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/internet explorer/i};for(e in o)if(o[e].test(t))return e;return"unknown"}}]),App.controller("ticketController",["$scope","$http","$sce","$interval","$location","browser",function(o,t,r,e,s,n){function l(e){if(!e||"string"!=typeof e)return"";for(var t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("iframe"),o="",r=0;r<t.length;r++){var s,n=t[r].getAttribute("src")||"";0===n.indexOf("https://")&&((s=document.createElement("iframe")).setAttribute("src",n),t[r].getAttribute("width")&&s.setAttribute("width",t[r].getAttribute("width")),t[r].getAttribute("height")&&s.setAttribute("height",t[r].getAttribute("height")),t[r].getAttribute("frameborder")&&s.setAttribute("frameborder",t[r].getAttribute("frameborder")),s.setAttribute("sandbox","allow-scripts allow-same-origin"),o+=s.outerHTML)}return o}o.ticket={},o.user={},o.returnedData={},o.iframeButton="",o.recordedVideo={},o.iframeVideo="",o.embedVideoURL="",o.token="",o.clicked=!0,o.ticket.browser=n(),console.log("Broswer service: ",o.ticket.browser),o.createTicket=function(e){console.log(e),t.post("/ticket/createTicket",e).success(function(e,t,o,r){console.log("Ticket Created ",t)}),o.ticket={},s.path("/allTickets")},t.get("/users/user").success(function(e){console.log("User response: ",e),o.user=e,o.ticket.email=o.user.email,console.log("Email: ",o.user.email)}),t.get("/api/getData").success(function(e){console.log(e),o.returnedData=e,o.iframeButton=r.trustAsHtml(l(o.returnedData.recordButtonIframe)),o.token=o.returnedData.token,console.log("iframe button: ",o.iframeButton)}).error(function(e){console.log(e)}),o.getVideo=function(){e(function(){t.get("/videos/"+o.token).success(function(e){var t=e.length-1;console.log("SetInterval Happens"),console.log("Video Data: ",e),console.log("Video URL: ",e[t].videoURL),o.recordedVideo=e,o.iframeVideo=r.trustAsHtml(l(o.recordedVideo[t].iframe)),o.token===e[0].token?o.matchToken=!0:o.matchToken=!1}).error(function(e){console.log(e)})},5e3)},o.getVideo()}]),App.controller("calculatorController",["$scope",function(t){var o="",r="";t.equal=function(){if(/^[0-9+\-*/. ]+$/.test(o))try{o=Function('"use strict"; return ('+o+")")()+Math.PI}catch(e){o="Error"}else o="Error";t.output=o,r="equal"},t.opBtn=function(e){o+=e,t.output=o,r=e},t.numBtn=function(e){r=("equal"==r?o=e:o+=e,t.output=o,e)},t.clear=function(){o="",t.output=o,r=""}}]),App.controller("headerController",["$scope","$http","$location",function(t,e,o){console.log("headerController loaded"),t.showUser=!1,t.waitMsg=!1,e.get("/users/user").success(function(e){console.log("User reponse: ",e),"false"==e?t.showLogin=!0:(t.showUser=!0,t.user=e.name.first+" "+e.name.last),t.waitMsg=!1}),t.showWaitMsg=function(){t.waitMsg=!0},t.logout=function(){e.get("/users/logout").success(function(e){t.showLogin=!0,t.showUser=!1,console.log(e+" has been logged out"),o.path("/home")})}}]),App.controller("registerController",["$scope","$http","$location","$window",function(n,l,i,c){n.newUser={},n.waitMsg=!1,n.createUser=function(s){n.waitMsg=!0,l.post("/users/create",s).success(function(e,t,o,r){console.log("User Created ",t),l.post("/",{email:s.email,password:s.password}).then(function(e,t){console.log("User is logged in",t),n.newUser={},c.location.reload(i.path("/home"))})})}}]).directive("pwCheck",function(){return{require:"ngModel",link:function(e,t,o,r){var s=angular.element(document.getElementById(o.pwCheck));t.on("keyup",function(){console.log("Retype password: ",t.val()),e.$apply(function(){console.log("first password: ",s.val()),console.log(t.val()===s.val()),r.$setValidity("pwMatch",t.val()===s.val())})})}}}),App.controller("allTicketController",["$scope","$http",function(o,r){o.tickets=[],o.allTickets=[],o.openTickets=[],o.archivedTickets=[],o.closedTickets=[],o.ticket={},o.users=[],o.userInfo={},r.get("/users/admin").success(function(e){console.log("All tickets page User response: ",e),o.admin=e}),o.getTickets=function(){r.get("/ticket/getTickets").then(function(e){o.allTickets=e.data,console.log("All Tickets",o.allTickets),o.openTickets=[],o.archivedTickets=[],o.closedTickets=[];for(var t=0;t<o.allTickets.length;t++)"Resolved"==o.allTickets[t].tktStatus?o.closedTickets.push(o.allTickets[t]):"Open"==o.allTickets[t].tktStatus&&o.openTickets.push(o.allTickets[t]);o.viewtkt("Open")})},o.viewtkt=function(e){o.tickets=[],"All"==e?o.tickets=o.allTickets:"Resolved"==e?(console.log("closedTickets: ",o.closedTickets),o.tickets=o.closedTickets):"Open"==e&&(o.tickets=o.openTickets,console.log("openTickets: ",o.openTickets))},o.ticketClass=function(e,t){return console.log("Ticket: ",e),console.log("Ticket Status: ",t),o.chgTktSts={tktStatus:t,_id:e._id},r.put("/ticket/updateStatus/",o.chgTktSts).success(o.getTickets)},o.getTickets()}]),App.controller("apiInstructionsController",["$scope",function(e){e.codeExample2=!1,e.codeExample3=!1,e.codeExample4=!1,e.codeExample5=!1,e.codeExample6=!1}]);