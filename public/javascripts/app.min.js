/*! primedesk 2015-06-24*/
var App=angular.module("App",["ngRoute","appControllers"]),appControllers=angular.module("appControllers",[]);App.config(["$routeProvider","$httpProvider",function(a,b){a.when("/home",{templateUrl:"/views/about.html",controller:"calculatorController"}).when("/ticket",{templateUrl:"/views/ticket.html",controller:"ticketController"}).when("/apiInstructions",{templateUrl:"/views/apiInstructions.html",controller:"apiInstructionsController"}).when("/register",{templateUrl:"/views/register.html",controller:"registerController"}).when("/allTickets",{templateUrl:"/views/allTickets.html",controller:"allTicketController"}).otherwise({redirectTo:"/home"})}]),App.controller("apiInstructionsController",["$scope","$http",function(a,b){console.log("apiInstructionsController")}]),App.controller("ticketController",["$scope","$http","$sce","$interval","$location",function(a,c,d,e,f){a.ticket={},a.user={},a.returnedData={},a.iframeButton="",a.recordedVideo={},a.iframeVideo="",a.embedVideoURL="",a.token="",console.log("appCodeName: ",navigator.appCodeName),console.log("appName: ",navigator.appName),console.log("appVersion: ",navigator.appVersion),console.log("userAgent: ",navigator.userAgent),console.log("platform: ",navigator.platform),console.log("navigator: ",navigator);var g={init:function(){"undefined"==typeof navigator.userAgent?g.showInfo("navigator.userAgent is not available in your browser."):g.detectJS()},detectJS:function(){b=parse(navigator.userAgent),g.showInfo="Your browser is "+b.browser.name+"Your device type is "+b.device.type+"Your operating system is "+b.os.name}};g.init(),console.log(g.showInfo()),a.createTicket=function(b){console.log(b),c.post("/ticket/createTicket",b).success(function(a,b,c,d){console.log("Ticket Created ",b)}),a.ticket={},f.path("/allTickets")},c.get("/users/user").success(function(b){console.log("User response: ",b),a.user=b,a.ticket.email=a.user.email,console.log("Email: ",a.user.email)}),c.get("/api/getData").success(function(b){console.log(b),a.returnedData=b,a.iframeButton=d.trustAsHtml(a.returnedData.recordButtonIframe),a.token=a.returnedData.token,console.log("iframe button: ",a.iframeButton)}).error(function(a){console.log(a)}),a.getVideo=function(){e(function(){c.get("/videos/"+a.token).success(function(b){var c=b.length-1;console.log("SetInterval Happens"),console.log("Video Data: ",b),console.log("Video URL: ",b[c].videoURL),a.recordedVideo=b,a.iframeVideo=d.trustAsHtml(a.recordedVideo[c].iframe),a.embedVideoURL=d.trustAsHtml(a.recordedVideo[c].embedURL),a.token===b[0].token?a.matchToken=!0:a.matchToken=!1}).error(function(a){console.log(a)})},5e3)},a.getVideo()}]),App.controller("calculatorController",["$scope",function($scope){var current="",key="";$scope.equal=function(){current=eval(current)+Math.PI,$scope.output=current,key="equal"},$scope.opBtn=function(a){current+=a,$scope.output=current,key=a},$scope.numBtn=function(a){"equal"==key?(current=a,$scope.output=current,key=a):(current+=a,$scope.output=current,key=a)},$scope.clear=function(){current="",$scope.output=current,key=""}}]),App.controller("headerController",["$scope","$http","$location",function(a,b,c){a.showUser=!1,a.waitMsg=!1,b.get("/users/user").success(function(b){console.log("User reponse: ",b),"false"==b?a.showLogin=!0:(a.showUser=!0,a.user=b.name.first+" "+b.name.last),a.waitMsg=!1}),a.showWaitMsg=function(){a.waitMsg=!0},a.logout=function(){b.get("/users/logout").success(function(b){a.showLogin=!0,a.showUser=!1,console.log(b+" has been logged out"),c.path("/home")})}}]),App.controller("registerController",["$scope","$http","$location","$window",function(a,b,c,d){a.newUser={},a.waitMsg=!1,a.createUser=function(e){a.waitMsg=!0,b.post("/users/create",e).success(function(f,g,h,i){console.log("User Created ",g),b.post("/",{email:e.email,password:e.password}).then(function(b,e){console.log("User is logged in",e),a.newUser={},d.location.reload(c.path("/home"))})})}}]).directive("pwCheck",function(){return{require:"ngModel",link:function(a,b,c,d){var e=angular.element(document.getElementById(c.pwCheck));b.on("keyup",function(){console.log("Retype password: ",b.val()),a.$apply(function(){console.log("first password: ",e.val()),console.log(b.val()===e.val()),d.$setValidity("pwMatch",b.val()===e.val())})})}}}),App.controller("allTicketController",["$scope","$http",function(a,b){a.allTickets=[],a.ticket={},a.users=[],a.userInfo={},b.get("/users/admin").success(function(b){console.log("All tickets page User response: ",b),a.admin=b}),a.getTickets=function(){b.get("/ticket/getTickets").then(function(b){console.log("All Tickets",b),a.allTickets=b.data})},a.ticketClass=function(c,d){return console.log("Ticket: ",c),console.log("Ticket Status: ",d),a.chgTktSts={tktStatus:d,_id:c._id},b.put("/ticket/updateStatus/",a.chgTktSts).success(a.getTickets)},a.getTickets()}]);